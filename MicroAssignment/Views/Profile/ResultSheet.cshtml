@model IEnumerable<MicroAssignment.Models.ReplyAssignment>

@{
    ViewBag.Title = "ResultSheet";
    int sn = 1;
    var db = new MicroAssignment.Models.MicroContext();
}
<!-- Page Heading/Breadcrumbs -->
        <div class="row">
            <div class="col-lg-12">
               <div class="alert alert-info">
                     <button type="button" class="close" data-dismiss="alert">&times;</button>
                     <strong><i class="icon-user icon-large"></i><strong style="font-size:18px">Result Sheet</strong> &nbsp; </strong>
                </div>
                <ol class="breadcrumb">
                    <li>@Html.ActionLink("<< Bact to control panel","ControlPanel","Profile")
                    </li>
                    <li class="active">Menu</li>
                </ol>
            </div>
        </div>
        <!-- /.row -->

<span style="float:right; font-weight:normal"><a href="" class="btn btn-info btn-xs" onclick="printSelection(document.getElementById('test'));return false">Print</a></span>


<div id="test">
    <div style="background-image:url('../../Images/bg00000.png');background-repeat:no-repeat;background-position:center;margin-left:auto;margin-right:auto;margin-top:40px">
    <p style="height:60px; text-align:center;font-size:1.5em;color:#fff;background-color:rgba(22, 143, 121, 0.89)">Micro-Assignment</p>
        <hr />
    <h5 style="text-decoration:underline;color:#a11d1d; font-weight:bold">SCORE SHEET</h5>  
    <h5 style="text-decoration:underline;color:#a11d1d; font-weight:bold">COURSE CODE: @ViewBag.Code </h5>
    <h5 style="text-decoration:underline;color:#a11d1d; font-weight:bold">COURSE NAME: @ViewBag.Name </h5>
<p style="text-align:center;font-weight:bold;font-size:1.2em">
    ASSIGNMENT ON : @ViewBag.Assignment
    
</p>
<table class="table table-hover table-bordered table-striped" style="text-align:left; border:solid 1px #373636;width:100%;display:table;border-bottom-style:solid;">
    <tr style="border:solid 1px #373636;font-weight:bold;font-size:1.1em;text-align:left;text-transform:uppercase">
        <th style="border:solid 1px #373636;">
            S/N
        </th>
        <th style="border:solid 1px #373636;">
            RegNo
        </th>
        <th style="border:solid 1px #373636;">
            Name
        </th>
        <th style="border:solid 1px #373636;">
            Asigmt Score
        </th>
        <th style="border:solid 1px #373636;">
            Test SCore
        </th>
        <th style="border:solid 1px #373636;">
            Exam Score
        </th>
        <th style="border:solid 1px #373636;">
            Avrage Score
        </th>
      
    </tr>

@foreach (var item in Model) {
    var userDetails = db.UserProfiles.FirstOrDefault(x => x.UserId == item.StudentId);
    
    <tr style="border:solid 1px #373636;font-weight:bold">
        <td style="border:solid 1px #373636;">
            @(sn++)
        </td>
        @if (userDetails.RegistrationNumber != null)
        {
            <td style="border:solid 1px #373636;color:#000">
                @userDetails.RegistrationNumber.ToUpper()
            </td>
        }
        else
        {
            <td style="border:solid 1px #373636;color:#fff;background-color:#e12424;width:auto">
                N / A
            </td>
        }
        <td style="border:solid 1px #373636;">
            @userDetails.FullName.ToUpper()
        </td>
        <td style="border:solid 1px #373636;">
            @Html.DisplayFor(modelItem => item.Score)
            @if (item.Score == null)
            {
                <span>N/A</span>
            }
        </td>
        <td style="border:solid 1px #373636;">
            @Html.DisplayFor(modelItem => item.TestScore)
            @if (item.TestScore == null)
            {
                <span>N/A</span>
            }
        </td>
        <td style="border:solid 1px #373636;">
            @Html.DisplayFor(modelItem => item.ExamScore)
            @if (item.ExamScore == null)
            {
                <span>N/A</span>
            }
        </td>
        <td style="border:solid 1px #373636;">
            @Html.DisplayFor(modelItem => item.Avrage)
            @if (item.Avrage == null)
            {
                <span>N/A</span>
            }
        </td>
 
    </tr>
}

</table>
</div>
</div>

 <script type="text/javascript">
        function printSelection(node) {
            var content = node.innerHTML
            var pwin = window.open('', 'print_content', 'width=1000,height=800');
            pwin.document.open();
            pwin.document.write('<html><body onload="window.print()">' + content + '</body></html>');
            pwin.document.close();
            setTimeout(function () { pwin.close(); }, 1000);
        }
    </script>